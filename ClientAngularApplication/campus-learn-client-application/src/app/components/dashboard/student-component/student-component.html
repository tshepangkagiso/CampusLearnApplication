<!-- navigation.component.html -->
<nav class="navbar">
  <div class="nav-container">
    <!-- Logo and Brand -->
    <div class="nav-brand">
      <h1>CampusLearnâ„¢</h1>
    </div>

    <!-- Navigation Links -->
    <div class="nav-links">
      <a class="nav-link" [routerLink]="['/student']">Home</a>
      <a class="nav-link" [routerLink]="['/student/topics']">Topics</a>
      <a class="nav-link" [routerLink]="['/student/forums']">Forum</a>
      <a class="nav-link" [routerLink]="['/student/messages']">Messages</a>
      <a class="nav-link" [routerLink]="['/student/chatbot']">Chatbot</a>
      <a class="nav-link" [routerLink]="['/student/faqs']">FAQs</a>
    </div>

    <!-- User Menu -->
    <div class="nav-user">
      <div class="user-menu">
        <span class="user-greeting">Welcome! {{student?.name}} {{student?.surname}}</span>
        <button class="logout-btn" (click)="onLogout()">Logout</button>
      </div>
    </div>
  </div>
</nav>

<div class="dashboard">
  <!-- Header -->
  <div class="dashboard-header">
    <h1>Student Dashboard</h1>
    <p>Manage your profile and module subscriptions</p>
  </div>

  <!-- Profile Section -->
  <section class="dashboard-card profile-section" *ngIf="student">
    <!-- Profile Sidebar -->
    <div class="profile-sidebar">
      <div class="profile-picture-section" *ngIf="student.profilePictureUrl">
        <img [src]="profilePicture" alt="Profile Picture" class="profile-picture-large">
      </div>
      <div class="profile-stats">
        <div class="stat-card">
          <span class="stat-number">{{subscribedModules?.totalSubscriptions || 0}}</span>
          <span class="stat-label">Subscribed Modules</span>
        </div>
        <div class="stat-card">
          <span class="stat-number">{{availableModules?.totalAvailable || 0}}</span>
          <span class="stat-label">Available Modules</span>
        </div>
      </div>
    </div>

    <!-- Profile Main Content -->
    <div class="profile-main">
      <h2>Profile Information</h2>
      
      <!-- Personal Information -->
      <div class="info-grid">
        <div class="info-item">
          <label>Full Name</label>
          <span>{{student.name}} {{student.surname}}</span>
        </div>
        <div class="info-item">
          <label>Email</label>
          <span>{{student.email}}</span>
        </div>
        <div class="info-item">
          <label>Student Number</label>
          <span>{{student.studentNumber}}</span>
        </div>
        <div class="info-item">
          <label>Qualification</label>
          <span>{{getQualificationText(student.qualification)}}</span>
        </div>
        <div class="info-item">
          <label>User Role</label>
          <span>{{getUserRoleText(role)}}</span>
        </div>
        <div class="info-item">
          <label>Account Status</label>
          <span [class.active]="student.isActive" [class.inactive]="!student.isActive">
            {{student.isActive ? 'Active' : 'Inactive'}}
          </span>
        </div>
        <div class="info-item">
          <label>Member Since</label>
          <span>{{formatDate(student.createdAt)}}</span>
        </div>
        <div class="info-item" *ngIf="student.lastLogin">
          <label>Last Login</label>
          <span>{{formatDate(student.lastLogin)}}</span>
        </div>
      </div>
    </div>
  </section>

  <!-- Update Profile Section -->
  <section class="dashboard-card" *ngIf="student && updateStudent">
    <h2>Update Profile</h2>
    <form (ngSubmit)="onSubmit()" #formRef="ngForm" class="form-grid">
      <div class="form-group">
        <label>Name</label>
        <input type="text" [(ngModel)]="updateStudent.name" name="name" required>
      </div>
      
      <div class="form-group">
        <label>Surname</label>
        <input type="text" [(ngModel)]="updateStudent.surname" name="surname" required>
      </div>
      
      <div class="form-group">
        <label>Email</label>
        <input type="email" [(ngModel)]="updateStudent.email" name="email" required>
      </div>
      
      <div class="form-group">
        <label>Student Number</label>
        <input type="number" [(ngModel)]="updateStudent.studentNumber" name="studentNumber" required readonly>
      </div>
      
      <div class="form-group">
        <label for="qualification">Qualification</label>
        <select 
          id="qualification"
          [(ngModel)]="updateStudent.qualification" 
          name="qualification" 
          required>
          <option [value]="qualification.DIP">Diploma</option>
          <option [value]="qualification.BIT">BIT</option>
          <option [value]="qualification.BCOM">BCom</option>
        </select>
      </div>
      
      <div class="form-group">
        <label>Profile Picture</label>
        <input type="file" (change)="onFileSelected($event)" accept="image/*">
      </div>
      
      <div class="form-group" style="grid-column: 1 / -1;">
        <button type="submit" [disabled]="formRef.invalid || isUpdating" class="update-btn">
          <span *ngIf="!isUpdating">Update Profile</span>
          <div *ngIf="isUpdating" class="spinner"></div>
        </button>
      </div>
    </form>
  </section>

  <!-- Modules Grid -->
  <div class="modules-grid">
    <!-- Available Modules -->
    <section class="dashboard-card modules-section" *ngIf="availableModules">
      <h2>Available Modules</h2>
      <div class="modules-container">
        <div class="module-card" *ngFor="let module of availableModules.notSubscribedModules">
          <div class="module-info">
            <h3>{{ module.moduleName }}</h3>
            <p class="module-code">{{ module.moduleCode }}</p>
          </div>
          <button class="subscribe-btn" (click)="subscribeToModule(module.moduleCode)">
            Subscribe
          </button>
        </div>
      </div>
      <div *ngIf="availableModules.notSubscribedModules.length === 0" class="no-modules">
        <p>No available modules to subscribe to</p>
      </div>
    </section>

    <!-- Subscribed Modules -->
    <section class="dashboard-card modules-section" *ngIf="subscribedModules">
      <h2>My Subscriptions</h2>
      <div class="modules-container">
        <div class="module-card" *ngFor="let module of subscribedModules.subscribedModules">
          <div class="module-info">
            <h3>{{ module.moduleName }}</h3>
            <p class="module-code">{{ module.moduleCode }}</p>
          </div>
          <button class="unsubscribe-btn" (click)="unsubscribeFromModule(module.moduleCode)">
            Unsubscribe
          </button>
        </div>
      </div>
      <div *ngIf="subscribedModules.subscribedModules.length === 0" class="no-modules">
        <p>You are not subscribed to any modules yet</p>
      </div>
    </section>
  </div>

  <!-- Loading State -->
  <div *ngIf="!student" class="loading dashboard-card">
    <p>Loading your profile...</p>
  </div>
</div>